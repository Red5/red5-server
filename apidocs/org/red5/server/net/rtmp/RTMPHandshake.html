<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) on Fri May 23 10:27:24 PDT 2025 -->
<title>RTMPHandshake (Red5 2.0.18 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2025-05-23">
<meta name="description" content="declaration: package: org.red5.server.net.rtmp, class: RTMPHandshake">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/RTMPHandshake.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Summary:</p>
<ul>
<li>Nested</li>
<li><a href="#field-summary">Field</a></li>
<li><a href="#constructor-summary">Constr</a></li>
<li><a href="#method-summary">Method</a></li>
</ul>
</li>
<li>
<p>Detail:</p>
<ul>
<li><a href="#field-detail">Field</a></li>
<li><a href="#constructor-detail">Constr</a></li>
<li><a href="#method-detail">Method</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li><a href="#field-detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.red5.server.net.rtmp</a></div>
<h1 title="Class RTMPHandshake" class="title">Class RTMPHandshake</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance">org.red5.server.net.rtmp.RTMPHandshake</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../IHandshake.html" title="interface in org.red5.server.net">IHandshake</a></code></dd>
</dl>
<dl class="notes">
<dt>Direct Known Subclasses:</dt>
<dd><code><a href="InboundHandshake.html" title="class in org.red5.server.net.rtmp">InboundHandshake</a></code>, <code><a href="../../../client/net/rtmp/OutboundHandshake.html" title="class in org.red5.client.net.rtmp">OutboundHandshake</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public abstract class </span><span class="element-name type-name-label">RTMPHandshake</span>
<span class="extends-implements">extends <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a>
implements <a href="../IHandshake.html" title="interface in org.red5.server.net">IHandshake</a></span></div>
<div class="block">Generates and validates the RTMP handshake response for Flash Players. Client versions equal to or greater than Flash 9,0,124,0 require a
 nonzero value as the fifth byte of the handshake request.</div>
<dl class="notes">
<dt>Author:</dt>
<dd>Jacinto Shy II (jacinto.m.shy@ieee.org), Steven Zimmer (stevenlzimmer@gmail.com), Gavriloaie Eugen-Andrei, Ari-Pekka Viitanen, Paul Gregoire, Tiago Jacobs</dd>
</dl>
</section>
<section class="summary">
<ul class="summary-list">
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="caption"><span>Fields</span></div>
<div class="summary-table three-column-summary">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Field</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><code>protected int</code></div>
<div class="col-second even-row-color"><code><a href="#algorithm" class="member-name-link">algorithm</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected org.bouncycastle.crypto.engines.BlowfishEngine</code></div>
<div class="col-second odd-row-color"><code><a href="#blowfish" class="member-name-link">blowfish</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected static final byte[][]</code></div>
<div class="col-second even-row-color"><code><a href="#BLOWFISH_KEYS" class="member-name-link">BLOWFISH_KEYS</a></code></div>
<div class="col-last even-row-color">
<div class="block">Blowfish keys for RTMPE (RTMP type 0x09) - 16 x 24</div>
</div>
<div class="col-first odd-row-color"><code>protected <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></code></div>
<div class="col-second odd-row-color"><code><a href="#cipherIn" class="member-name-link">cipherIn</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></code></div>
<div class="col-second even-row-color"><code><a href="#cipherOut" class="member-name-link">cipherOut</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected static final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/math/BigInteger.html" title="class or interface in java.math" class="external-link">BigInteger</a></code></div>
<div class="col-second odd-row-color"><code><a href="#DH_BASE" class="member-name-link">DH_BASE</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Constant <code>DH_BASE</code></div>
</div>
<div class="col-first even-row-color"><code>protected static final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/math/BigInteger.html" title="class or interface in java.math" class="external-link">BigInteger</a></code></div>
<div class="col-second even-row-color"><code><a href="#DH_MODULUS" class="member-name-link">DH_MODULUS</a></code></div>
<div class="col-last even-row-color">
<div class="block">Constant <code>DH_MODULUS</code></div>
</div>
<div class="col-first odd-row-color"><code>protected static final byte[]</code></div>
<div class="col-second odd-row-color"><code><a href="#DH_MODULUS_BYTES" class="member-name-link">DH_MODULUS_BYTES</a></code></div>
<div class="col-last odd-row-color">
<div class="block">"Second Oakley Default Group" from RFC2409, section 6.2.</div>
</div>
<div class="col-first even-row-color"><code>protected static final int</code></div>
<div class="col-second even-row-color"><code><a href="#DIGEST_LENGTH" class="member-name-link">DIGEST_LENGTH</a></code></div>
<div class="col-last even-row-color">
<div class="block">Constant <code>DIGEST_LENGTH=32</code></div>
</div>
<div class="col-first odd-row-color"><code>protected boolean</code></div>
<div class="col-second odd-row-color"><code><a href="#fp9Handshake" class="member-name-link">fp9Handshake</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>static final byte[]</code></div>
<div class="col-second even-row-color"><code><a href="#GENUINE_FMS_KEY" class="member-name-link">GENUINE_FMS_KEY</a></code></div>
<div class="col-last even-row-color">
<div class="block">Constant <code>GENUINE_FMS_KEY</code></div>
</div>
<div class="col-first odd-row-color"><code>static final byte[]</code></div>
<div class="col-second odd-row-color"><code><a href="#GENUINE_FP_KEY" class="member-name-link">GENUINE_FP_KEY</a></code></div>
<div class="col-last odd-row-color">
<div class="block">Constant <code>GENUINE_FP_KEY</code></div>
</div>
<div class="col-first even-row-color"><code>static final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</code></div>
<div class="col-second even-row-color"><code><a href="#HANDSHAKE_TYPES" class="member-name-link">HANDSHAKE_TYPES</a></code></div>
<div class="col-last even-row-color">
<div class="block">Constant <code>HANDSHAKE_TYPES</code></div>
</div>
<div class="col-first odd-row-color"><code>protected byte[]</code></div>
<div class="col-second odd-row-color"><code><a href="#handshakeBytes" class="member-name-link">handshakeBytes</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected byte</code></div>
<div class="col-second even-row-color"><code><a href="#handshakeType" class="member-name-link">handshakeType</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected byte[]</code></div>
<div class="col-second odd-row-color"><code><a href="#incomingPublicKey" class="member-name-link">incomingPublicKey</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected static final int</code></div>
<div class="col-second even-row-color"><code><a href="#KEY_LENGTH" class="member-name-link">KEY_LENGTH</a></code></div>
<div class="col-last even-row-color">
<div class="block">Constant <code>KEY_LENGTH=128</code></div>
</div>
<div class="col-first odd-row-color"><code>protected <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/KeyAgreement.html" title="class or interface in javax.crypto" class="external-link">KeyAgreement</a></code></div>
<div class="col-second odd-row-color"><code><a href="#keyAgreement" class="member-name-link">keyAgreement</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected org.slf4j.Logger</code></div>
<div class="col-second even-row-color"><code><a href="#log" class="member-name-link">log</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected byte[]</code></div>
<div class="col-second odd-row-color"><code><a href="#outgoingPublicKey" class="member-name-link">outgoingPublicKey</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected static final <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Random.html" title="class or interface in java.util" class="external-link">Random</a></code></div>
<div class="col-second even-row-color"><code><a href="#random" class="member-name-link">random</a></code></div>
<div class="col-last even-row-color">
<div class="block">Constant <code>random</code></div>
</div>
<div class="col-first odd-row-color"><code>protected int</code></div>
<div class="col-second odd-row-color"><code><a href="#swfSize" class="member-name-link">swfSize</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected byte[]</code></div>
<div class="col-second even-row-color"><code><a href="#swfVerificationBytes" class="member-name-link">swfVerificationBytes</a></code></div>
<div class="col-last even-row-color">&nbsp;</div>
<div class="col-first odd-row-color"><code>protected org.bouncycastle.crypto.engines.XTEAEngine</code></div>
<div class="col-second odd-row-color"><code><a href="#xtea" class="member-name-link">xtea</a></code></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><code>protected static final byte[][]</code></div>
<div class="col-second even-row-color"><code><a href="#XTEA_KEYS" class="member-name-link">XTEA_KEYS</a></code></div>
<div class="col-last even-row-color">
<div class="block">XTEA keys for RTMPE (RTMP type 0x08) - 16 x 16 (little endian)</div>
</div>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E()" class="member-name-link">RTMPHandshake</a>()</code></div>
<div class="col-last even-row-color">
<div class="block">Constructor for RTMPHandshake.</div>
</div>
<div class="col-constructor-name odd-row-color"><code><a href="#%3Cinit%3E(byte)" class="member-name-link">RTMPHandshake</a><wbr>(byte&nbsp;handshakeType)</code></div>
<div class="col-last odd-row-color">
<div class="block">Constructor for RTMPHandshake.</div>
</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab1" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab1', 3)" class="table-tab">Static Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#calculateDigest(int,byte%5B%5D,int,byte%5B%5D,int,byte%5B%5D,int)" class="member-name-link">calculateDigest</a><wbr>(int&nbsp;digestPos,
 byte[]&nbsp;handshakeMessage,
 int&nbsp;handshakeOffset,
 byte[]&nbsp;key,
 int&nbsp;keyLen,
 byte[]&nbsp;digest,
 int&nbsp;digestOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Calculates the digest given the its offset in the handshake data.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#calculateHMAC_SHA256(byte%5B%5D,int,int,byte%5B%5D,int,byte%5B%5D,int)" class="member-name-link">calculateHMAC_SHA256</a><wbr>(byte[]&nbsp;message,
 int&nbsp;messageOffset,
 int&nbsp;messageLen,
 byte[]&nbsp;key,
 int&nbsp;keyLen,
 byte[]&nbsp;digest,
 int&nbsp;digestOffset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Calculates an HMAC SHA256 hash into the digest at the given offset.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#calculateSwfVerification(byte%5B%5D,byte%5B%5D,int)" class="member-name-link">calculateSwfVerification</a><wbr>(byte[]&nbsp;handshakeMessage,
 byte[]&nbsp;swfHash,
 int&nbsp;swfSize)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Calculates the swf verification token.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>protected abstract void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#createHandshakeBytes()" class="member-name-link">createHandshakeBytes</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Create the initial bytes for a request / response.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#generateKeyPair()" class="member-name-link">generateKeyPair</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Creates a Diffie-Hellman key pair.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getBlowfishSignature(byte%5B%5D,int,int)" class="member-name-link">getBlowfishSignature</a><wbr>(byte[]&nbsp;array,
 int&nbsp;offset,
 int&nbsp;keyId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">RTMPE type 9 uses Blowfish on the regular signature http://en.wikipedia.org/wiki/Blowfish_(cipher)</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCipherIn()" class="member-name-link">getCipherIn</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the contained handshake bytes.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getCipherOut()" class="member-name-link">getCipherOut</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Gets the DH offset in the handshake bytes array based on validation scheme Generates DH keypair Adds public key to handshake bytes</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDHOffset(int,byte%5B%5D,int)" class="member-name-link">getDHOffset</a><wbr>(int&nbsp;algorithm,
 byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the DH offset from an array of bytes.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDHOffset1(byte%5B%5D,int)" class="member-name-link">getDHOffset1</a><wbr>(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the DH byte offset.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDHOffset2(byte%5B%5D,int)" class="member-name-link">getDHOffset2</a><wbr>(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the DH byte offset.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDigestOffset(int,byte%5B%5D,int)" class="member-name-link">getDigestOffset</a><wbr>(int&nbsp;algorithm,
 byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the digest offset using current validation scheme.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected int</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDigestOffset1(byte%5B%5D,int)" class="member-name-link">getDigestOffset1</a><wbr>(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a digest byte offset.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected int</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getDigestOffset2(byte%5B%5D,int)" class="member-name-link">getDigestOffset2</a><wbr>(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns a digest byte offset.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getHandshakeType()" class="member-name-link">getHandshakeType</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the handshake type.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getPublicKey(java.security.KeyPair)" class="member-name-link">getPublicKey</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;keyPair)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the public key for a given key pair.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected byte[]</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getSharedSecret(byte%5B%5D,javax.crypto.KeyAgreement)" class="member-name-link">getSharedSecret</a><wbr>(byte[]&nbsp;publicKeyBytes,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/KeyAgreement.html" title="class or interface in javax.crypto" class="external-link">KeyAgreement</a>&nbsp;agreement)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Determines the validation scheme for given input.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>byte[]</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getSwfVerificationBytes()" class="member-name-link">getSwfVerificationBytes</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Returns the SWF verification bytes.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getXteaSignature(byte%5B%5D,int,int)" class="member-name-link">getXteaSignature</a><wbr>(byte[]&nbsp;array,
 int&nbsp;offset,
 int&nbsp;keyId)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">RTMPE type 8 uses XTEA on the regular signature http://en.wikipedia.org/wiki/XTEA</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#initBlowfishEncryption(int)" class="member-name-link">initBlowfishEncryption</a><wbr>(int&nbsp;keyId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">initBlowfishEncryption.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#initRC4Encryption(byte%5B%5D)" class="member-name-link">initRC4Encryption</a><wbr>(byte[]&nbsp;sharedSecret)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Prepare the ciphers.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#initXteaEncryption(int)" class="member-name-link">initXteaEncryption</a><wbr>(int&nbsp;keyId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">initXteaEncryption.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#setHandshakeType(byte)" class="member-name-link">setHandshakeType</a><wbr>(byte&nbsp;handshakeType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sets the handshake type.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#useEncryption()" class="member-name-link">useEncryption</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Whether or not encryptions is in use.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>abstract boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#validate(byte%5B%5D)" class="member-name-link">validate</a><wbr>(byte[]&nbsp;handshake)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Determines the validation scheme for given input.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code>static final boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4"><code><a href="#validHandshakeType(byte)" class="member-name-link">validHandshakeType</a><wbr>(byte&nbsp;handshakeType)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab1 method-summary-table-tab4">
<div class="block">Returns whether or not a given handshake type is valid.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#verifyDigest(int,byte%5B%5D,byte%5B%5D,int)" class="member-name-link">verifyDigest</a><wbr>(int&nbsp;digestPos,
 byte[]&nbsp;handshakeMessage,
 byte[]&nbsp;key,
 int&nbsp;keyLen)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Verifies the digest.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.red5.server.net.IHandshake">Methods inherited from interface&nbsp;org.red5.server.net.<a href="../IHandshake.html" title="interface in org.red5.server.net">IHandshake</a></h3>
<code><a href="../IHandshake.html#doHandshake(org.apache.mina.core.buffer.IoBuffer)">doHandshake</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ FIELD DETAIL =========== -->
<li>
<section class="field-details" id="field-detail">
<h2>Field Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="log">
<h3>log</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">org.slf4j.Logger</span>&nbsp;<span class="element-name">log</span></div>
</section>
</li>
<li>
<section class="detail" id="HANDSHAKE_TYPES">
<h3>HANDSHAKE_TYPES</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>[]</span>&nbsp;<span class="element-name">HANDSHAKE_TYPES</span></div>
<div class="block">Constant <code>HANDSHAKE_TYPES</code></div>
</section>
</li>
<li>
<section class="detail" id="GENUINE_FMS_KEY">
<h3>GENUINE_FMS_KEY</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">GENUINE_FMS_KEY</span></div>
<div class="block">Constant <code>GENUINE_FMS_KEY</code></div>
</section>
</li>
<li>
<section class="detail" id="GENUINE_FP_KEY">
<h3>GENUINE_FP_KEY</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">GENUINE_FP_KEY</span></div>
<div class="block">Constant <code>GENUINE_FP_KEY</code></div>
</section>
</li>
<li>
<section class="detail" id="DH_MODULUS_BYTES">
<h3>DH_MODULUS_BYTES</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">DH_MODULUS_BYTES</span></div>
<div class="block">"Second Oakley Default Group" from RFC2409, section 6.2.</div>
</section>
</li>
<li>
<section class="detail" id="XTEA_KEYS">
<h3>XTEA_KEYS</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type">byte[][]</span>&nbsp;<span class="element-name">XTEA_KEYS</span></div>
<div class="block">XTEA keys for RTMPE (RTMP type 0x08) - 16 x 16 (little endian)</div>
</section>
</li>
<li>
<section class="detail" id="BLOWFISH_KEYS">
<h3>BLOWFISH_KEYS</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type">byte[][]</span>&nbsp;<span class="element-name">BLOWFISH_KEYS</span></div>
<div class="block">Blowfish keys for RTMPE (RTMP type 0x09) - 16 x 24</div>
</section>
</li>
<li>
<section class="detail" id="DH_MODULUS">
<h3>DH_MODULUS</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/math/BigInteger.html" title="class or interface in java.math" class="external-link">BigInteger</a></span>&nbsp;<span class="element-name">DH_MODULUS</span></div>
<div class="block">Constant <code>DH_MODULUS</code></div>
</section>
</li>
<li>
<section class="detail" id="DH_BASE">
<h3>DH_BASE</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/math/BigInteger.html" title="class or interface in java.math" class="external-link">BigInteger</a></span>&nbsp;<span class="element-name">DH_BASE</span></div>
<div class="block">Constant <code>DH_BASE</code></div>
</section>
</li>
<li>
<section class="detail" id="DIGEST_LENGTH">
<h3>DIGEST_LENGTH</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">DIGEST_LENGTH</span></div>
<div class="block">Constant <code>DIGEST_LENGTH=32</code></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../../../../../constant-values.html#org.red5.server.net.rtmp.RTMPHandshake.DIGEST_LENGTH">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="KEY_LENGTH">
<h3>KEY_LENGTH</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">KEY_LENGTH</span></div>
<div class="block">Constant <code>KEY_LENGTH=128</code></div>
<dl class="notes">
<dt>See Also:</dt>
<dd>
<ul class="tag-list">
<li><a href="../../../../../constant-values.html#org.red5.server.net.rtmp.RTMPHandshake.KEY_LENGTH">Constant Field Values</a></li>
</ul>
</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="random">
<h3>random</h3>
<div class="member-signature"><span class="modifiers">protected static final</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/Random.html" title="class or interface in java.util" class="external-link">Random</a></span>&nbsp;<span class="element-name">random</span></div>
<div class="block">Constant <code>random</code></div>
</section>
</li>
<li>
<section class="detail" id="keyAgreement">
<h3>keyAgreement</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/KeyAgreement.html" title="class or interface in javax.crypto" class="external-link">KeyAgreement</a></span>&nbsp;<span class="element-name">keyAgreement</span></div>
</section>
</li>
<li>
<section class="detail" id="cipherOut">
<h3>cipherOut</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></span>&nbsp;<span class="element-name">cipherOut</span></div>
</section>
</li>
<li>
<section class="detail" id="cipherIn">
<h3>cipherIn</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></span>&nbsp;<span class="element-name">cipherIn</span></div>
</section>
</li>
<li>
<section class="detail" id="xtea">
<h3>xtea</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">org.bouncycastle.crypto.engines.XTEAEngine</span>&nbsp;<span class="element-name">xtea</span></div>
</section>
</li>
<li>
<section class="detail" id="blowfish">
<h3>blowfish</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">org.bouncycastle.crypto.engines.BlowfishEngine</span>&nbsp;<span class="element-name">blowfish</span></div>
</section>
</li>
<li>
<section class="detail" id="handshakeType">
<h3>handshakeType</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte</span>&nbsp;<span class="element-name">handshakeType</span></div>
</section>
</li>
<li>
<section class="detail" id="handshakeBytes">
<h3>handshakeBytes</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">handshakeBytes</span></div>
</section>
</li>
<li>
<section class="detail" id="incomingPublicKey">
<h3>incomingPublicKey</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">incomingPublicKey</span></div>
</section>
</li>
<li>
<section class="detail" id="outgoingPublicKey">
<h3>outgoingPublicKey</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">outgoingPublicKey</span></div>
</section>
</li>
<li>
<section class="detail" id="swfSize">
<h3>swfSize</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">swfSize</span></div>
</section>
</li>
<li>
<section class="detail" id="swfVerificationBytes">
<h3>swfVerificationBytes</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">swfVerificationBytes</span></div>
</section>
</li>
<li>
<section class="detail" id="algorithm">
<h3>algorithm</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">algorithm</span></div>
</section>
</li>
<li>
<section class="detail" id="fp9Handshake">
<h3>fp9Handshake</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">fp9Handshake</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;()">
<h3>RTMPHandshake</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">RTMPHandshake</span>()</div>
<div class="block"><p>Constructor for RTMPHandshake.</p></div>
</section>
</li>
<li>
<section class="detail" id="&lt;init&gt;(byte)">
<h3>RTMPHandshake</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">RTMPHandshake</span><wbr><span class="parameters">(byte&nbsp;handshakeType)</span></div>
<div class="block"><p>Constructor for RTMPHandshake.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakeType</code> - a byte</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="initRC4Encryption(byte[])">
<h3>initRC4Encryption</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">initRC4Encryption</span><wbr><span class="parameters">(byte[]&nbsp;sharedSecret)</span></div>
<div class="block">Prepare the ciphers.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>sharedSecret</code> - shared secret byte sequence</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initXteaEncryption(int)">
<h3>initXteaEncryption</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">initXteaEncryption</span><wbr><span class="parameters">(int&nbsp;keyId)</span></div>
<div class="block"><p>initXteaEncryption.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>keyId</code> - a int</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="initBlowfishEncryption(int)">
<h3>initBlowfishEncryption</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">initBlowfishEncryption</span><wbr><span class="parameters">(int&nbsp;keyId)</span></div>
<div class="block"><p>initBlowfishEncryption.</p></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>keyId</code> - a int</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="generateKeyPair()">
<h3>generateKeyPair</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a></span>&nbsp;<span class="element-name">generateKeyPair</span>()</div>
<div class="block">Creates a Diffie-Hellman key pair.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>dh keypair</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getPublicKey(java.security.KeyPair)">
<h3>getPublicKey</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getPublicKey</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/security/KeyPair.html" title="class or interface in java.security" class="external-link">KeyPair</a>&nbsp;keyPair)</span></div>
<div class="block">Returns the public key for a given key pair.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>keyPair</code> - key pair</dd>
<dt>Returns:</dt>
<dd>public key</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSharedSecret(byte[],javax.crypto.KeyAgreement)">
<h3>getSharedSecret</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getSharedSecret</span><wbr><span class="parameters">(byte[]&nbsp;publicKeyBytes,
 <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/KeyAgreement.html" title="class or interface in javax.crypto" class="external-link">KeyAgreement</a>&nbsp;agreement)</span></div>
<div class="block">Determines the validation scheme for given input.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>publicKeyBytes</code> - public key bytes</dd>
<dd><code>agreement</code> - key agreement</dd>
<dt>Returns:</dt>
<dd>shared secret bytes if client used a supported validation scheme</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="createHandshakeBytes()">
<h3>createHandshakeBytes</h3>
<div class="member-signature"><span class="modifiers">protected abstract</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">createHandshakeBytes</span>()</div>
<div class="block">Create the initial bytes for a request / response.</div>
</section>
</li>
<li>
<section class="detail" id="validate(byte[])">
<h3>validate</h3>
<div class="member-signature"><span class="modifiers">public abstract</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">validate</span><wbr><span class="parameters">(byte[]&nbsp;handshake)</span></div>
<div class="block">Determines the validation scheme for given input.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../IHandshake.html#validate(byte%5B%5D)">validate</a></code>&nbsp;in interface&nbsp;<code><a href="../IHandshake.html" title="interface in org.red5.server.net">IHandshake</a></code></dd>
<dt>Parameters:</dt>
<dd><code>handshake</code> - handshake byte sequence</dd>
<dt>Returns:</dt>
<dd>true if its a supported validation scheme, false if unsupported</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="calculateDigest(int,byte[],int,byte[],int,byte[],int)">
<h3>calculateDigest</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">calculateDigest</span><wbr><span class="parameters">(int&nbsp;digestPos,
 byte[]&nbsp;handshakeMessage,
 int&nbsp;handshakeOffset,
 byte[]&nbsp;key,
 int&nbsp;keyLen,
 byte[]&nbsp;digest,
 int&nbsp;digestOffset)</span></div>
<div class="block">Calculates the digest given the its offset in the handshake data.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>digestPos</code> - digest position</dd>
<dd><code>handshakeMessage</code> - handshake message</dd>
<dd><code>handshakeOffset</code> - handshake message offset</dd>
<dd><code>key</code> - contains the key</dd>
<dd><code>keyLen</code> - the length of the key</dd>
<dd><code>digest</code> - contains the calculated digest</dd>
<dd><code>digestOffset</code> - digest offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="verifyDigest(int,byte[],byte[],int)">
<h3>verifyDigest</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">verifyDigest</span><wbr><span class="parameters">(int&nbsp;digestPos,
 byte[]&nbsp;handshakeMessage,
 byte[]&nbsp;key,
 int&nbsp;keyLen)</span></div>
<div class="block">Verifies the digest.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>digestPos</code> - digest position</dd>
<dd><code>handshakeMessage</code> - handshake message</dd>
<dd><code>key</code> - contains the key</dd>
<dd><code>keyLen</code> - the length of the key</dd>
<dt>Returns:</dt>
<dd>true if valid and false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="calculateHMAC_SHA256(byte[],int,int,byte[],int,byte[],int)">
<h3>calculateHMAC_SHA256</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">calculateHMAC_SHA256</span><wbr><span class="parameters">(byte[]&nbsp;message,
 int&nbsp;messageOffset,
 int&nbsp;messageLen,
 byte[]&nbsp;key,
 int&nbsp;keyLen,
 byte[]&nbsp;digest,
 int&nbsp;digestOffset)</span></div>
<div class="block">Calculates an HMAC SHA256 hash into the digest at the given offset.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>message</code> - incoming bytes</dd>
<dd><code>messageOffset</code> - message offset</dd>
<dd><code>messageLen</code> - message length</dd>
<dd><code>key</code> - incoming key bytes</dd>
<dd><code>keyLen</code> - the length of the key</dd>
<dd><code>digest</code> - contains the calculated digest</dd>
<dd><code>digestOffset</code> - digest offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="calculateSwfVerification(byte[],byte[],int)">
<h3>calculateSwfVerification</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">calculateSwfVerification</span><wbr><span class="parameters">(byte[]&nbsp;handshakeMessage,
 byte[]&nbsp;swfHash,
 int&nbsp;swfSize)</span></div>
<div class="block">Calculates the swf verification token.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakeMessage</code> - servers handshake bytes</dd>
<dd><code>swfHash</code> - hash of swf</dd>
<dd><code>swfSize</code> - size of swf</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDHOffset(int,byte[],int)">
<h3>getDHOffset</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getDHOffset</span><wbr><span class="parameters">(int&nbsp;algorithm,
 byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</span></div>
<div class="block">Returns the DH offset from an array of bytes.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>algorithm</code> - validation algorithm</dd>
<dd><code>handshake</code> - handshake sequence</dd>
<dd><code>bufferOffset</code> - buffer offset</dd>
<dt>Returns:</dt>
<dd>DH offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDHOffset1(byte[],int)">
<h3>getDHOffset1</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getDHOffset1</span><wbr><span class="parameters">(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</span></div>
<div class="block">Returns the DH byte offset.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshake</code> - handshake sequence</dd>
<dd><code>bufferOffset</code> - buffer offset</dd>
<dt>Returns:</dt>
<dd>dh offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDHOffset2(byte[],int)">
<h3>getDHOffset2</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getDHOffset2</span><wbr><span class="parameters">(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</span></div>
<div class="block">Returns the DH byte offset.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshake</code> - handshake sequence</dd>
<dd><code>bufferOffset</code> - buffer offset</dd>
<dt>Returns:</dt>
<dd>dh offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDigestOffset(int,byte[],int)">
<h3>getDigestOffset</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getDigestOffset</span><wbr><span class="parameters">(int&nbsp;algorithm,
 byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</span></div>
<div class="block">Returns the digest offset using current validation scheme.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>algorithm</code> - validation algorithm</dd>
<dd><code>handshake</code> - handshake sequence</dd>
<dd><code>bufferOffset</code> - buffer offset</dd>
<dt>Returns:</dt>
<dd>digest offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDigestOffset1(byte[],int)">
<h3>getDigestOffset1</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getDigestOffset1</span><wbr><span class="parameters">(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</span></div>
<div class="block">Returns a digest byte offset.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshake</code> - handshake sequence</dd>
<dd><code>bufferOffset</code> - buffer offset</dd>
<dt>Returns:</dt>
<dd>digest offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getDigestOffset2(byte[],int)">
<h3>getDigestOffset2</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">int</span>&nbsp;<span class="element-name">getDigestOffset2</span><wbr><span class="parameters">(byte[]&nbsp;handshake,
 int&nbsp;bufferOffset)</span></div>
<div class="block">Returns a digest byte offset.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshake</code> - handshake sequence</dd>
<dd><code>bufferOffset</code> - buffer offset</dd>
<dt>Returns:</dt>
<dd>digest offset</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getXteaSignature(byte[],int,int)">
<h3>getXteaSignature</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">getXteaSignature</span><wbr><span class="parameters">(byte[]&nbsp;array,
 int&nbsp;offset,
 int&nbsp;keyId)</span></div>
<div class="block">RTMPE type 8 uses XTEA on the regular signature http://en.wikipedia.org/wiki/XTEA</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>array</code> - array to get signature</dd>
<dd><code>offset</code> - offset to start from</dd>
<dd><code>keyId</code> - a int</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getBlowfishSignature(byte[],int,int)">
<h3>getBlowfishSignature</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">getBlowfishSignature</span><wbr><span class="parameters">(byte[]&nbsp;array,
 int&nbsp;offset,
 int&nbsp;keyId)</span></div>
<div class="block">RTMPE type 9 uses Blowfish on the regular signature http://en.wikipedia.org/wiki/Blowfish_(cipher)</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>array</code> - array to get signature</dd>
<dd><code>offset</code> - offset to start from</dd>
<dd><code>keyId</code> - index of Blowfish key</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="validHandshakeType(byte)">
<h3>validHandshakeType</h3>
<div class="member-signature"><span class="modifiers">public static final</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">validHandshakeType</span><wbr><span class="parameters">(byte&nbsp;handshakeType)</span></div>
<div class="block">Returns whether or not a given handshake type is valid.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakeType</code> - the type of handshake</dd>
<dt>Returns:</dt>
<dd>true if valid and supported, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="useEncryption()">
<h3>useEncryption</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">useEncryption</span>()</div>
<div class="block">Whether or not encryptions is in use.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../IHandshake.html#useEncryption()">useEncryption</a></code>&nbsp;in interface&nbsp;<code><a href="../IHandshake.html" title="interface in org.red5.server.net">IHandshake</a></code></dd>
<dt>Returns:</dt>
<dd>true if handshake type is an encrypted type, false otherwise</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="setHandshakeType(byte)">
<h3>setHandshakeType</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">setHandshakeType</span><wbr><span class="parameters">(byte&nbsp;handshakeType)</span></div>
<div class="block">Sets the handshake type. Currently only two types are supported, plain and encrypted.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>handshakeType</code> - handshake type</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getHandshakeType()">
<h3>getHandshakeType</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte</span>&nbsp;<span class="element-name">getHandshakeType</span>()</div>
<div class="block">Returns the handshake type.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>handshakeType</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCipherOut()">
<h3>getCipherOut</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></span>&nbsp;<span class="element-name">getCipherOut</span>()</div>
<div class="block">Gets the DH offset in the handshake bytes array based on validation scheme Generates DH keypair Adds public key to handshake bytes</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>cipher</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getCipherIn()">
<h3>getCipherIn</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/javax/crypto/Cipher.html" title="class or interface in javax.crypto" class="external-link">Cipher</a></span>&nbsp;<span class="element-name">getCipherIn</span>()</div>
<div class="block">Returns the contained handshake bytes. These are just random bytes if the player is using an non-versioned player.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>cipher</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getSwfVerificationBytes()">
<h3>getSwfVerificationBytes</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">byte[]</span>&nbsp;<span class="element-name">getSwfVerificationBytes</span>()</div>
<div class="block">Returns the SWF verification bytes.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>swf verification bytes</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2005&#x2013;2025 <a href="https://github.com/Red5">Red5</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
